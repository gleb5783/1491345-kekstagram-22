{"version":3,"sources":["webpack://kekstagram/./source/js/preview-img.js","webpack://kekstagram/webpack/bootstrap","webpack://kekstagram/./source/js/utils.js","webpack://kekstagram/./source/js/users-card-filter.js","webpack://kekstagram/./source/js/effects.js","webpack://kekstagram/./source/js/server.js","webpack://kekstagram/./source/js/validity-form.js","webpack://kekstagram/./source/js/download-new-picture.js"],"names":["FILE_TYPES","fileChooser","document","querySelector","preview","addEventListener","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","src","result","readAsDataURL","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","isEscEvent","evt","key","loadMoreButton","filterDiscussed","filterRandom","filterDefault","pictures","bigPicture","documentBody","bigPictureComments","bigPictureImg","bigPictureLikesCount","bigPictureStartCommentsCount","bigPictureCommentsCount","bigPictureCancel","pictureTemplate","content","picturesFragment","createDocumentFragment","createCommentsFragment","comments","commentTemplate","commentFragment","forEach","comment","newComment","cloneNode","avatar","alt","textContent","message","appendChild","sortCommentsImgs","img1","img2","length","sortRandomImgs","Math","random","removeUsersCard","classList","remove","target","toggle","allUsersPictures","querySelectorAll","i","lastChild","closeCommentLoadButton","picture","add","renderUsersCard","images","newPicture","url","likes","onBigPictureClose","removeEventListener","onShowMoreComments","onNewPictureClose","innerHTML","slice","onDebounceFilterImages","debounceFilter","window","_","debounce","sortingRandomImages","sort","sortingImagesComment","previewImage","sliderElement","effectValue","filterSlider","deleteClass","className","effects","none","chrome","sliderSettings","range","min","max","start","step","getFilterStyle","Number","sepia","marvin","phobos","heat","noUiSlider","create","connect","errorTemplate","errorTemplateButton","successTemplate","mainBlock","closeSuccessButton","filter","onEscClose","onEscErrorClose","onSubmitImageForm","preventDefault","formData","FormData","fetch","method","body","then","response","ok","showSuccessModal","showErrorModal","catch","onClickRemove","onClickErrorRemove","onSuccessTemplate","onTemplateErrorClose","closeForm","json","addDefaultUsersCard","addRandomUsersCard","addFilterComments","inputHashTags","regExp","onHashTagsInput","hashTagsValue","value","split","isValid","item","setCustomValidity","test","array","index","indexOf","findDuplicates","reportValidity","imgForm","effectNone","imgOverlay","imgOverlayClose","imgUpload","scaleValue","smallerScale","inputComment","biggerScale","onPopUpEscPress","activeElement","onImgOverlayClose","addScaleValue","parseInt","style","transform","onBiggerScaleButton","disabled","onSmallerScaleButton","effectName","onApplyFilterEfect","on","values","handle","updateOptions","changeFilterSetings","checked"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst fileChooser = document.querySelector('.img-upload__start input[type=file]');\nconst preview = document.querySelector('.img-upload__preview img');\n\nfileChooser.addEventListener('change', () => {\n  const file = fileChooser.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      preview.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  }\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const ESC_BUTTON = 'Esc';\nconst ESCAPE_BUTTON = 'Escape';\n\nconst isEscEvent = (evt) => {\n  return evt.key === ESCAPE_BUTTON || evt.key === ESC_BUTTON;\n};\n\nfunction findDuplicates(array) {\n  return array.filter((item, index) => array.indexOf(item) !== index);\n}\n\nfunction hasDuplicates(array) {\n  return array.length > 1 && findDuplicates(array).length > 0;\n}\n\nexport {isEscEvent, hasDuplicates};\n","import {isEscEvent} from './utils.js';\n\nconst MIN_COMMENT_COUNT = 0;\nconst MAX_FIRST_COMMENTS = 5;\nconst MAX_RANDOM_USERS_CARD = 10;\nconst DEBOUNCE_DELAY = 500;\nconst loadMoreButton = document.querySelector('.social__comments-loader');\nconst filterDiscussed = document.querySelector('#filter-discussed');\nconst filterRandom = document.querySelector('#filter-random');\nconst filterDefault = document.querySelector('#filter-default');\nconst pictures = document.querySelector('.pictures');\nconst bigPicture = document.querySelector('.big-picture');\nconst documentBody = document.querySelector('body');\nconst bigPictureComments = document.querySelector('.social__comments');\nconst bigPictureImg = bigPicture.querySelector('.big-picture__img img');\nconst bigPictureLikesCount = bigPicture.querySelector('.likes-count');\nconst bigPictureStartCommentsCount = bigPicture.querySelector('.comment-start');\nconst bigPictureCommentsCount = bigPicture.querySelector('.comments-count');\nconst bigPictureCancel = bigPicture.querySelector('#picture-cancel');\n\nconst pictureTemplate = document.querySelector('#picture').content.querySelector('.picture');\n\nconst picturesFragment = document.createDocumentFragment();\n\nconst createCommentsFragment = (comments) => {\n  const commentTemplate = document.querySelector('#comment').content.querySelector('.social__comment');\n  const commentFragment = document.createDocumentFragment();\n  comments.forEach((comment) => {\n    const newComment = commentTemplate.cloneNode(true);\n\n    newComment.querySelector('img').src = comment.avatar;\n    newComment.querySelector('img').alt = comment.name;\n    newComment.querySelector('.social__text').textContent = comment.message;\n\n    commentFragment.appendChild(newComment);\n  });\n\n  return commentFragment;\n}\n\nconst sortCommentsImgs = (img1, img2) => {\n  return img1.comments.length > img2.comments.length ? -1 : 1;\n}\n\nconst sortRandomImgs = () => {\n  return 0.5 - Math.random();\n}\n\nconst removeUsersCard = (evt) => {\n  document.querySelector('.img-filters__button--active').classList.remove('img-filters__button--active');\n  evt.target.classList.toggle('img-filters__button--active');\n  const allUsersPictures = document.querySelectorAll('.picture');\n\n  for (let i = 1; i <= allUsersPictures.length; i++) {\n    pictures.lastChild.remove();\n  }\n}\n\nconst closeCommentLoadButton = (picture, i) => {\n  if(i >= picture.comments.length) {\n    loadMoreButton.classList.add('hidden');\n  }\n  else {\n    loadMoreButton.classList.remove('hidden');\n  }\n}\n\nconst renderUsersCard = (images) => {\n  images.forEach((picture) => {\n    const newPicture = pictureTemplate.cloneNode(true);\n    newPicture.querySelector('.picture__img').src = picture.url;\n    newPicture.querySelector('.picture__comments').textContent = picture.comments.length;\n    newPicture.querySelector('.picture__likes').textContent = picture.likes;\n\n    newPicture.addEventListener('click', () => {\n      let i = 5;\n\n      const onBigPictureClose = () => {\n        bigPicture.classList.add('hidden');\n        documentBody.classList.remove('modal-open');\n        loadMoreButton.removeEventListener('click', onShowMoreComments);\n        document.removeEventListener('keydown', onNewPictureClose);\n        bigPictureCancel.removeEventListener('click', onBigPictureClose);\n      }\n\n      const onShowMoreComments = () => {\n        bigPictureComments.innerHTML = '';\n        i = i + MAX_FIRST_COMMENTS;\n        bigPictureComments.appendChild(createCommentsFragment(picture.comments.slice(MIN_COMMENT_COUNT, i)));\n\n        if (i > picture.comments.length) {\n          bigPictureStartCommentsCount.textContent = picture.comments.length;\n        }\n        else {\n          bigPictureStartCommentsCount.textContent = i;\n        }\n        closeCommentLoadButton(picture, i);\n        return i\n      }\n\n      const onNewPictureClose = (evt) => {\n        if (isEscEvent(evt)) {\n          bigPicture.classList.add('hidden');\n          documentBody.classList.remove('modal-open');\n          loadMoreButton.removeEventListener('click', onShowMoreComments);\n          bigPictureCancel.removeEventListener('click', onBigPictureClose);\n        }\n      }\n\n      bigPictureCancel.addEventListener('click', onBigPictureClose);\n\n      loadMoreButton.addEventListener('click', onShowMoreComments);\n      document.addEventListener('keydown', onNewPictureClose);\n      bigPicture.classList.remove('hidden');\n      documentBody.classList.add('modal-open');\n      bigPictureImg.src = picture.url;\n      bigPictureStartCommentsCount.textContent = MAX_FIRST_COMMENTS;\n      if(i >= picture.comments.length) {\n        bigPictureStartCommentsCount.textContent = picture.comments.length;\n      }\n      bigPictureLikesCount.textContent = picture.likes;\n      bigPictureCommentsCount.textContent = picture.comments.length;\n      bigPictureComments.innerHTML = '';\n      closeCommentLoadButton(picture, i);\n      bigPictureComments.appendChild(createCommentsFragment(picture.comments.slice(MIN_COMMENT_COUNT, i)));\n    });\n\n    picturesFragment.appendChild(newPicture);\n  });\n  pictures.appendChild(picturesFragment);\n}\n\n\n\nconst onFilterFunction = (evt, images) => {\n  if(evt.target === filterRandom) {\n    removeUsersCard(evt);\n    const sortingRandomImages = images.slice().sort(sortRandomImgs).slice(MIN_COMMENT_COUNT, MAX_RANDOM_USERS_CARD);\n    renderUsersCard(sortingRandomImages);\n  }\n  if(evt.target === filterDefault) {\n    removeUsersCard(evt);\n    renderUsersCard(images);\n  }\n  if(evt.target === filterDiscussed) {\n    removeUsersCard(evt);\n    const sortingImagesComment = images.slice().sort(sortCommentsImgs);\n    renderUsersCard(sortingImagesComment);\n  }\n}\nconst onDebounceFilterImages = (evt, images) => {\n  debounceFilter(evt, images);\n}\nconst debounceFilter = window._.debounce(onFilterFunction, DEBOUNCE_DELAY);\n\nconst addRandomUsersCard = (images) => {\n  filterRandom.addEventListener('click', (evt) => {\n    onDebounceFilterImages(evt, images);\n  });\n}\n\nconst addDefaultUsersCard = (images) => {\n  filterDefault.addEventListener('click', (evt) => {\n    onDebounceFilterImages(evt, images);\n  });\n}\n\nconst addFilterComments = (images) => {\n  filterDiscussed.addEventListener('click', (evt) => {\n    onDebounceFilterImages(evt, images);\n  });\n}\n\n\nexport {renderUsersCard, addFilterComments, addRandomUsersCard, addDefaultUsersCard};\n\n\n","const EFFECT_NONE = 'none';\nconst MIN_RANGE = 0;\nconst START_SLIDER = 80;\nconst STEP_SLIDER = 1;\nconst MAX_RANGE = 100;\nconst previewImage = document.querySelector('.img-upload__preview img');\nconst sliderElement = document.querySelector('.effect-level__slider');\nconst effectValue = document.querySelector('.effect-level__value');\nconst filterSlider = document.querySelector('.img-upload__effect-level');\n\nconst deleteClass = () => {\n  for (let className of previewImage.classList) {\n    previewImage.classList.remove(className);\n  }\n}\n\nconst effects = {\n  none: {\n\n  },\n\n  chrome: {\n    sliderSettings: {\n      range: {\n        min: 0,\n        max: 1,\n      },\n      start: 1,\n      step: 0.1,\n    },\n    getFilterStyle: (effectValue) => `grayscale(${Number(effectValue)})`,\n  },\n\n  sepia: {\n    sliderSettings: {\n      range: {\n        min: 0,\n        max: 1,\n      },\n      start: 1,\n      step: 0.1,\n    },\n    getFilterStyle: (effectValue) => `sepia(${Number(effectValue)})`,\n  },\n\n  marvin: {\n    sliderSettings: {\n      range: {\n        min: 0,\n        max: 100,\n      },\n      start: 100,\n      step: 1,\n    },\n    getFilterStyle: (effectValue) => `invert(${Number(effectValue)}%)`,\n  },\n\n  phobos: {\n    sliderSettings: {\n      range: {\n        min: 0,\n        max: 3,\n      },\n      start: 3,\n      step: 0.1,\n    },\n    getFilterStyle: (effectValue) => `blur(${Number(effectValue)}px)`,\n  },\n\n  heat: {\n    sliderSettings: {\n      range: {\n        min: 1,\n        max: 3,\n      },\n      start: 3,\n      step: 0.1,\n    },\n    getFilterStyle: (effectValue) => `brightness(${Number(effectValue)})`,\n  },\n}\n\nwindow.noUiSlider.create(sliderElement, {\n  range: {\n    min: MIN_RANGE,\n    max: MAX_RANGE,\n  },\n  start: START_SLIDER,\n  step: STEP_SLIDER,\n  connect: 'lower',\n});\n\nconst changeFilterSetings = () => {\n  for(let effectName in effects) {\n    const effectNames = document.querySelector(`#effect-${effectName}`);\n    const onApplyFilterEfect = () => {\n      deleteClass();\n      if (effectName === EFFECT_NONE) {\n        effectValue.value = '';\n        previewImage.style.filter = '';\n        filterSlider.classList.add('hidden');\n      }\n      else {\n        filterSlider.classList.remove('hidden');\n        previewImage.classList.add(`effects__preview--${effectName}`);\n        sliderElement.noUiSlider.on('update', (values, handle) => {\n          effectValue.value = values[handle];\n          previewImage.style.filter = effects[effectName].getFilterStyle(effectValue.value);\n        });\n\n        sliderElement.noUiSlider.updateOptions(effects[effectName].sliderSettings);\n      }\n    }\n    effectNames.addEventListener('change', onApplyFilterEfect);\n  }\n}\n\nexport{changeFilterSetings};\n\n\n","import {renderUsersCard, addDefaultUsersCard, addRandomUsersCard, addFilterComments} from './users-card-filter.js';\nimport {closeForm} from './download-new-picture.js';\nimport {isEscEvent} from './utils.js';\n\nconst errorTemplate = document.querySelector('#error').content.querySelector('.error');\nconst errorTemplateButton = document.querySelector('#error').content.querySelector('.error__button');\nconst successTemplate = document.querySelector('#success').content.querySelector('.success');\nconst mainBlock = document.querySelector('main');\nconst closeSuccessButton = successTemplate.querySelector('.success__button');\nconst filter = document.querySelector('.img-filters');\n\nconst onEscClose = (evt) => {\n  if(isEscEvent(evt)) {\n    successTemplate.remove();\n  }\n}\n\nconst onEscErrorClose = (evt) => {\n  if(isEscEvent(evt)) {\n    errorTemplate.remove();\n  }\n}\n\nconst onSubmitImageForm = (evt) => {\n  evt.preventDefault();\n  const formData = new FormData(evt.target);\n\n  fetch(\n    'https://22.javascript.pages.academy/kekstagram',\n    {\n      method: 'POST',\n      body: formData,\n    },\n  )\n    .then((response) => {\n      if(response.ok){\n        showSuccessModal();\n        return;\n      }\n      showErrorModal();\n    })\n    .catch(showErrorModal);\n}\n\nconst onClickRemove = () => {\n  successTemplate.remove();\n}\n\nconst onClickErrorRemove = () => {\n  errorTemplate.remove();\n}\n\nconst onSuccessTemplate = () => {\n  successTemplate.remove();\n  document.removeEventListener('keydown', onEscClose);\n  document.removeEventListener('click', onClickRemove);\n  closeSuccessButton.removeEventListener('click', onSuccessTemplate);\n}\n\nconst onTemplateErrorClose = () => {\n  errorTemplate.remove();\n  document.removeEventListener('click', onClickErrorRemove);\n  document.removeEventListener('keydown', onEscErrorClose);\n  errorTemplateButton.removeEventListener('click', onTemplateErrorClose);\n}\n\nconst showSuccessModal = () => {\n  closeForm();\n  document.addEventListener('keydown', onEscClose);\n  document.addEventListener('click', onClickRemove);\n  closeSuccessButton.addEventListener('click', onSuccessTemplate);\n  mainBlock.appendChild(successTemplate);\n}\n\nconst showErrorModal = () => {\n  closeForm();\n  document.addEventListener('click', onClickErrorRemove);\n  document.addEventListener('keydown', onEscErrorClose);\n  errorTemplateButton.addEventListener('click', onTemplateErrorClose);\n  mainBlock.appendChild(errorTemplate);\n}\n\nfetch('https://22.javascript.pages.academy/kekstagram/data')\n  .then((response) => response.json())\n  .then((images) => {\n    renderUsersCard(images);\n    addDefaultUsersCard(images);\n    addRandomUsersCard(images);\n    addFilterComments(images);\n  })\n  .then(() => {\n    filter.classList.remove('img-filters--inactive');\n  })\n  .catch(() => {\n    document.body.innerHTML = '<div class=`error`><h1>Error</h1><span>Пожалуйста перезагрузите страницу</span></div>';\n  });\n\nexport {onSubmitImageForm};\n\n\n\n","import {hasDuplicates} from './utils.js';\n\nconst MAX_LENGTH_ALL_HASH_TAGS = 5;\nconst MAX_LENGTH_HASH_TAGS = 20;\nconst MIN_LENGTH_HASH_TAGS = 1;\nconst inputHashTags = document.querySelector('.text__hashtags');\nconst regExp = /^#[a-z0-9]+$/i;\n\n\nconst onHashTagsInput = () => {\n  const hashTagsValue = inputHashTags.value.toLowerCase().split(' ');\n  let isValid = true;\n\n  for (let item of hashTagsValue) {\n    if (item[0] !== '#') {\n      inputHashTags.setCustomValidity('Начни с #');\n      isValid = false;\n    }\n\n    else if (item.length > MAX_LENGTH_HASH_TAGS) {\n      inputHashTags.setCustomValidity('Максимальная длинна 20 символов');\n      isValid = false;\n    }\n\n    else if (item.length <= MIN_LENGTH_HASH_TAGS) {\n      inputHashTags.setCustomValidity('ХешТег не может состоять из одной #');\n      isValid = false;\n    }\n\n    else if (!regExp.test(item)) {\n      inputHashTags.setCustomValidity('Нельзя использовать специальные символы');\n      isValid = false;\n    }\n  }\n\n  if (hashTagsValue.length > MAX_LENGTH_ALL_HASH_TAGS) {\n    inputHashTags.setCustomValidity('Максимум 5 ХешТегов');\n    isValid = false;\n  }\n\n  else if (hasDuplicates(hashTagsValue)) {\n    inputHashTags.setCustomValidity('Нельзя использовать одинаковые ХешТеги');\n    isValid = false;\n  }\n\n  if (isValid === true) {\n    inputHashTags.setCustomValidity('');\n  }\n\n  inputHashTags.reportValidity();\n}\n\nexport{onHashTagsInput};\n","import {isEscEvent} from './utils.js';\nimport {changeFilterSetings} from './effects.js';\nimport {onSubmitImageForm} from './server.js';\nimport {onHashTagsInput} from './validity-form.js';\n\nconst MIN_SCALE_VALUE = 25;\nconst MAX_SCALE_VALUE = 100;\nconst imgForm = document.querySelector('#upload-select-image');\nconst effectNone = document.querySelector('#effect-none');\nconst filterSlider = document.querySelector('.img-upload__effect-level');\nconst imgOverlay = document.querySelector('.img-upload__overlay');\nconst imgOverlayClose = document.querySelector('#upload-cancel');\nconst imgUpload = document.querySelector('#upload-file');\nconst scaleValue = document.querySelector('.scale__control--value');\nconst previewImage = document.querySelector('.img-upload__preview img');\nconst smallerScale = document.querySelector('.scale__control--smaller');\nconst inputHashTags = document.querySelector('.text__hashtags');\nconst inputComment = document.querySelector('.text__description');\nconst biggerScale = document.querySelector('.scale__control--bigger');\n\n\nconst onPopUpEscPress = (evt) => {\n  if (isEscEvent(evt) && document.activeElement !== inputHashTags && document.activeElement !== inputComment) {\n    closeForm();\n  }\n}\n\nconst onImgOverlayClose = () => {\n  closeForm();\n}\n\nconst addScaleValue = (value)  => {\n  scaleValue.value = `${parseInt(scaleValue.value) + value}%`;\n  previewImage.style.transform = `scale(${parseInt(scaleValue.value) / MAX_SCALE_VALUE})`;\n}\n\nconst onBiggerScaleButton = () => {\n  addScaleValue(MIN_SCALE_VALUE);\n  smallerScale.disabled = false;\n  if (scaleValue.value === '100%') {\n    biggerScale.disabled = true;\n  }\n}\n\nconst onSmallerScaleButton = () => {\n  addScaleValue(-MIN_SCALE_VALUE);\n  biggerScale.disabled = false;\n  if (scaleValue.value === '25%') {\n    smallerScale.disabled = true;\n  }\n}\n\nimgUpload.addEventListener('change', () => {\n  smallerScale.disabled = false;\n  biggerScale.disabled = true;\n  imgForm.addEventListener('submit', onSubmitImageForm);\n  inputHashTags.addEventListener('input', onHashTagsInput);\n  changeFilterSetings();\n  imgOverlay.classList.remove('hidden');\n  document.querySelector('body').classList.add('modal-open');\n  smallerScale.addEventListener('click', onSmallerScaleButton);\n  biggerScale.addEventListener('click', onBiggerScaleButton);\n  imgOverlayClose.addEventListener('click', onImgOverlayClose);\n  document.addEventListener('keydown', onPopUpEscPress);\n});\n\nconst closeForm = () => {\n  inputHashTags.removeEventListener('input', onHashTagsInput);\n  imgForm.removeEventListener('submit', onSubmitImageForm);\n  effectNone.checked = true;\n  filterSlider.classList.add('hidden');\n  imgOverlay.classList.add('hidden');\n  document.querySelector('body').classList.remove('modal-open');\n  imgUpload.value = '';\n  previewImage.style.filter = 'none';\n  smallerScale.removeEventListener('click', onSmallerScaleButton);\n  biggerScale.removeEventListener('click', onBiggerScaleButton);\n  previewImage.style.transform = 'scale(1)';\n  scaleValue.value = '100%';\n  document.removeEventListener('keydown', onPopUpEscPress);\n  imgOverlayClose.removeEventListener('click', onImgOverlayClose);\n  inputHashTags.value = '';\n  inputComment.value = '';\n}\n\nexport {closeForm};\n"],"sourceRoot":""}